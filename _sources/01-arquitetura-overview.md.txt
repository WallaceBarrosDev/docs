# VisÃ£o Geral da Arquitetura

## DescriÃ§Ã£o

ðŸ—ï¸ VisÃ£o geral da arquitetura

O novo site serÃ¡ uma pÃ¡gina moderna e rÃ¡pida, feita em React, que mostra informaÃ§Ãµes atualizadas da loja de forma segura e automatizada.

Essa pÃ¡gina se conecta a uma API interna (um tipo de â€œponte inteligenteâ€), que tem trÃªs funÃ§Ãµes principais:

Fazer a autenticaÃ§Ã£o dos acessos â€” garantindo que apenas as pessoas ou sistemas autorizados consigam ver ou alterar informaÃ§Ãµes.

Cuidar do desempenho e estabilidade â€” ela guarda em cache dados que nÃ£o precisam ser buscados toda hora, o que torna o site mais rÃ¡pido.

Integrar com o sistema local da loja â€” em vez de buscar informaÃ§Ãµes direto no banco de dados da loja (que estÃ¡ no servidor interno), essa API se comunica com outra API que o sistema local jÃ¡ oferece, garantindo seguranÃ§a e evitando acessos diretos ao servidor.

Em resumo:

O site React mostra os dados de forma bonita e acessÃ­vel.

A API interna (Node.js) serve de filtro e proteÃ§Ã£o.

A API do sistema da loja fornece as informaÃ§Ãµes reais vindas do banco de dados.

Essa estrutura garante seguranÃ§a, velocidade e facilidade de manutenÃ§Ã£o, alÃ©m de deixar o site preparado para futuras expansÃµes, como login de clientes, estatÃ­sticas ou integraÃ§Ã£o com outros sistemas.

## Arquitetura do sistema

## Camadas da AplicaÃ§Ã£o

```{mermaid}
graph TD

%% ====== CLIENTE ======
subgraph Cliente
    Browser[Navegador Web]
end

%% ====== FRONTEND ======
subgraph Frontend["Frontend - React + TypeScript"]
    ReactApp[AplicaÃ§Ã£o React]
    State[Gerenciamento de Estado]
    ApiClient[Cliente de API]
end

%% ====== BACKEND ======
subgraph Backend["API Interna - Node.js / Express / TypeScript"]
    InternalAPI[API Interna]
    Auth[AutenticaÃ§Ã£o]
    Cache[(Cache / OtimizaÃ§Ã£o)]
    DataBridge[Camada de IntegraÃ§Ã£o]
end

%% ====== API EXTERNA ======
subgraph External["API Externa - Sistema Local da Loja"]
    LocalAPI[API do Sistema Local]
    LocalDB[(Banco de Dados Local)]
end

%% ====== FLUXO DE DADOS ======
Browser --> ReactApp
ReactApp --> ApiClient
ApiClient --> InternalAPI
InternalAPI --> Auth
InternalAPI --> Cache
InternalAPI --> DataBridge
DataBridge --> LocalAPI
LocalAPI --> LocalDB

%% ====== ESTILOS ======
style ReactApp fill:#61dafb,stroke:#333,stroke-width:1px
style InternalAPI fill:#68a063,stroke:#333,stroke-width:1px
style LocalAPI fill:#4479a1,stroke:#333,stroke-width:1px
style LocalDB fill:#375a7f,stroke:#333,stroke-width:1px
style Cache fill:#ff6b6b,stroke:#333,stroke-width:1px
style Auth fill:#fdd835,stroke:#333,stroke-width:1px
```

### 1. Camada de ApresentaÃ§Ã£o (Frontend)

Tecnologia: React 18 + TypeScript

Build Tool: Vite

Roteamento: React Router

HTTP Client: Axios

State Management: Context API / Zustand (futuro)

Responsabilidades:

Exibir a interface do site e apresentar os produtos e informaÃ§Ãµes da loja.

Cuidar da experiÃªncia do usuÃ¡rio, garantindo navegaÃ§Ã£o rÃ¡pida e moderna.

Fazer requisiÃ§Ãµes Ã  API interna para buscar dados atualizados.

Validar formulÃ¡rios e entradas antes de enviar ao servidor.

ðŸ’¡ O frontend Ã© o que o cliente vÃª â€” a vitrine digital da loja, feita para ser leve, rÃ¡pida e responsiva.

### 2. Camada de AplicaÃ§Ã£o (Backend / API Interna)

Tecnologia: Node.js + Express + TypeScript

Framework: Express.js

ValidaÃ§Ã£o: Joi / Zod

AutenticaÃ§Ã£o: JWT (futuro)

Responsabilidades:

Servir como ponte segura entre o site e o sistema local da loja.

Fazer autenticaÃ§Ã£o e controle de acesso.

Gerenciar performance com cache e tratamento de requisiÃ§Ãµes.

Orquestrar as chamadas para a API externa (do sistema local).

Evitar acessos diretos ao servidor interno da loja, mantendo a seguranÃ§a dos dados.

ðŸ’¡ A API interna Ã© como um â€œintÃ©rpreteâ€ â€” ela entende o que o site precisa, busca essas informaÃ§Ãµes de forma controlada e entrega de modo rÃ¡pido e seguro.

### 3. Camada de IntegraÃ§Ã£o (API Externa do Sistema Local)

Tecnologia: API do sistema interno (Delphi + Firebird)

Acesso: Servidor local da loja fÃ­sica

ComunicaÃ§Ã£o: Endpoints expostos pela empresa TecGestÃ£o

Responsabilidades:

Fornecer os dados reais do estoque, produtos e informaÃ§Ãµes da loja fÃ­sica.

Atender Ã s solicitaÃ§Ãµes da API interna sem expor o banco de dados diretamente.

Garantir que o site sempre mostre informaÃ§Ãµes atualizadas vindas do sistema principal.

ðŸ’¡ Essa camada Ã© o elo com o sistema da loja â€” ela centraliza as informaÃ§Ãµes e mantÃ©m tudo sincronizado sem comprometer a seguranÃ§a do servidor interno.

### (Opcional Futuro) 4. Camada de Dados e Performance

Cache: Redis ou memÃ³ria local (futuro)

Banco Auxiliar: PostgreSQL (para logs, sessÃµes ou histÃ³rico, se necessÃ¡rio)

Responsabilidades:

Melhorar a velocidade de resposta guardando dados temporÃ¡rios.

Reduzir requisiÃ§Ãµes desnecessÃ¡rias Ã  API local.

Aumentar a estabilidade do sistema em horÃ¡rios de pico.

## Fluxo de Dados

```{mermaid}
sequenceDiagram
participant U as ðŸ§‘ UsuÃ¡rio
participant F as ðŸŒ Frontend (React + TS)
participant I as ðŸ”„ API Interna (Node/Express)
participant E as ðŸ§© API Externa (Sistema Local)
participant DB as ðŸ—„ï¸ Banco de Dados Local

%% InteraÃ§Ã£o do usuÃ¡rio
U->>F: Interage com o site (navegaÃ§Ã£o, busca, etc.)
F->>F: ValidaÃ§Ã£o local e atualizaÃ§Ã£o de estado

%% ComunicaÃ§Ã£o com a API interna
F->>I: RequisiÃ§Ã£o HTTP (JSON / Axios)
I->>I: ValidaÃ§Ã£o e autenticaÃ§Ã£o (JWT / regras de negÃ³cio)

%% API interna se comunica com a API externa
I->>E: Solicita dados (produtos, estoque, etc.)
E->>DB: Consulta informaÃ§Ãµes no banco da loja
DB-->>E: Retorna os dados reais

%% Retorno da cadeia
E-->>I: Dados tratados da loja
I->>I: Processamento e cache (otimizaÃ§Ã£o de resposta)
I-->>F: Retorna dados prontos em JSON
F->>F: Atualiza o estado e renderiza componentes
F-->>U: Mostra as informaÃ§Ãµes atualizadas na tela
```

## PrincÃ­pios de Arquitetura

### 1. SeparaÃ§Ã£o de Responsabilidades
Cada camada tem uma responsabilidade especÃ­fica e bem definida.

### 2. API-First
O backend expÃµe uma API REST bem documentada, permitindo mÃºltiplos clientes.

### 3. Stateless
O backend nÃ£o mantÃ©m estado de sessÃ£o, usando tokens JWT.

### 4. Escalabilidade
Arquitetura preparada para escalar horizontalmente.

### 5. Testabilidade
Cada camada pode ser testada independentemente.

## Tecnologias e Ferramentas

### Frontend
- React 18.2+
- TypeScript 5.3+
- Vite 5.0+
- React Router 6.21+
- Axios 1.6+

### Backend
- Node.js 18+
- Express 4.18+
- TypeScript 5.3+
- Helmet (seguranÃ§a)
- CORS
- Morgan (logging)

### Desenvolvimento
- Git (controle de versÃ£o)
- ESLint (linting)
- Prettier (formataÃ§Ã£o)
- Vitest (testes)

## SeguranÃ§a

```{mermaid}

graph TD
A[RequisiÃ§Ã£o do Frontend] --> B{Token JWT presente?}
B -->|NÃ£o| E[401 Unauthorized]
B -->|Sim| C[Middleware de AutenticaÃ§Ã£o]
C --> D{Token vÃ¡lido?}
D -->|NÃ£o| E
D -->|Sim| F[ValidaÃ§Ã£o JWT]
F --> G[VerificaÃ§Ã£o de PermissÃµes]
G -->|NÃ£o autorizado| H[403 Forbidden]
G -->|Autorizado| I[Controller / Rota Protegida]
I --> J[ValidaÃ§Ã£o e SanitizaÃ§Ã£o de Dados]
J --> K[ComunicaÃ§Ã£o com API Externa]
K --> L[Retorno de Dados Processados]

%% ===== Estilos =====
style E fill:#ff6b6b,stroke:#333,stroke-width:1px
style H fill:#ff6b6b,stroke:#333,stroke-width:1px
style I fill:#51cf66,stroke:#333,stroke-width:1px
style K fill:#61dafb,stroke:#333,stroke-width:1px
style L fill:#68a063,stroke:#333,stroke-width:1px

```
